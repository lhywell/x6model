(function(t){function e(e){for(var i,r,s=e[0],l=e[1],c=e[2],d=0,p=[];d<s.length;d++)r=s[d],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&p.push(o[r][0]),o[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);u&&u(e);while(p.length)p.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,s=1;s<n.length;s++){var l=n[s];0!==o[l]&&(i=!1)}i&&(a.splice(e--,1),t=r(r.s=n[0]))}return t}var i={},o={app:0},a=[];function r(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/x6model/dist/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=l;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},2010:function(t,e,n){},"3ae8":function(t,e,n){"use strict";var i=n("6186"),o=n.n(i);o.a},"4f90":function(t,e,n){"use strict";var i=n("f5c4"),o=n.n(i);o.a},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("editor-com")],1)},a=[],r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor"},[n("h1",[t._v("战法模型")]),n("div",{staticClass:"content"},[n("div",{ref:"stencilContainer",staticClass:"app-stencil",attrs:{id:"app-stencil"}}),n("div",{staticClass:"panel"},[n("Toolbar"),n("div",{ref:"x6Editor",staticClass:"app-content",attrs:{id:"app-content"}})],1)]),t._t("rightPane",[n("modal",{attrs:{show:t.showAttrConfig,title:"属性配置"},on:{"update:show":function(e){t.showAttrConfig=e}},nativeOn:{keyup:function(t){t.stopPropagation()}}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("el-form",{attrs:{model:t.nodeFrmData,"label-width":"80px","label-position":"left"}},[n("el-form-item",{attrs:{label:"名称",prop:"name"}},[n("el-input",{model:{value:t.nodeFrmData.name,callback:function(e){t.$set(t.nodeFrmData,"name",e)},expression:"nodeFrmData.name"}})],1),n("el-form-item",{attrs:{label:"属性1",prop:"属性1"}},[n("el-input",{model:{value:t.nodeFrmData.属性1,callback:function(e){t.$set(t.nodeFrmData,"属性1",e)},expression:"nodeFrmData.属性1"}})],1),n("el-form-item",{attrs:{label:"属性2",prop:"属性2"}},[n("el-input",{model:{value:t.nodeFrmData.属性2,callback:function(e){t.$set(t.nodeFrmData,"属性2",e)},expression:"nodeFrmData.属性2"}})],1)],1)],1),n("span",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.close}},[t._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确定")])],1)])])],2)},s=[],l=(n("b0c0"),n("4160"),n("159b"),n("d4ec")),c=n("bee2"),u=n("5728"),d=n("8614"),p=u["a"].Stencil,f=(u["f"].BorderedImage,u["f"].HTML),h=function(){function t(e){Object(l["a"])(this,t),this.graph=null}return Object(c["a"])(t,null,[{key:"init",value:function(){var t=document.documentElement.clientHeight-48-39,e={container:document.getElementById("app-content"),height:t,history:!0,grid:{size:10,visible:!0,type:"doubleMesh",args:[{color:"#c5c5c5",thickness:1}]},snapline:{enabled:!0,sharp:!0},selecting:{enabled:!0,showNodeSelectionBox:!0,className:"my-selecting"},keyboard:{enabled:!0,global:!0,escape:!0},clipboard:{enabled:!0,offset:30,useLocalStorage:!0},panning:!0,connecting:{snap:!0,allowBlank:!1,allowLoop:!1,allowNode:!1,highlight:!0,connector:{name:"smooth"},validateMagnet:function(t){var e=t.magnet;return"in"!==e.getAttribute("port-group")},validateConnection:function(t){var e=t.sourceMagnet,n=t.targetMagnet;return!(!e||"in"===e.getAttribute("port-group"))&&!(!n||"in"!==n.getAttribute("port-group"))}}};return this.graph=new u["e"](e),this.graph.centerContent(),this.initStencil(),this.initEvent(),this.initKey(),this.graph}},{key:"initGraphShape",value:function(){this.graph.fromJSON(d)}},{key:"initKey",value:function(){var t=this.graph;t.bindKey(["meta+d"],(function(e){return t.clearCells(),!1}),"keyup"),t.bindKey(["meta+z"],(function(e){return t.undo(),!1}),"keyup"),t.bindKey(["meta+shift+z","ctrl+y"],(function(e){return t.redo(),!1}),"keyup"),t.bindKey(["ctrl+="],(function(e){return t.zoom(.1)})),t.bindKey(["ctrl+-"],(function(e){return t.zoom(-.1)})),t.bindKey(["meta+c","ctrl+c"],(function(e){var n=t.getSelectedCells();return n.length&&t.copy(n),!1}),"keyup"),t.bindKey(["meta+v","ctrl+v"],(function(e){if(!t.isClipboardEmpty()){var n=t.paste({offset:32});t.cleanSelection(),t.select(n)}return!1})),t.bindKey(["meta+x","ctrl+x"],(function(e){var n=t.getSelectedCells();return n.length&&t.cut(n),!1})),t.bindKey(["meta+s","ctrl+s"],(function(e){return t.toPNG((function(t){u["b"].downloadDataUri(t,"chart.png")})),!1})),t.bindKey(["meta+p","ctrl+p"],(function(e){t.printPreview()}))}},{key:"initEvent",value:function(){var t=this,e=this.graph;e.on("edge:click",(function(n){var i=n.edge;t.reset(e),i.attr("line/stroke","orange")})),e.on("node:click",(function(n){var i=n.e,o=n.x,a=n.y,r=n.node,s=n.view;t.reset(e),console.log(i,o,a,r,s)})),this.portEvent(e)}},{key:"reset",value:function(t){var e=t.getNodes(),n=t.getEdges();e.forEach((function(t){t.attr("rect/stroke","#108ee9")})),n.forEach((function(t){t.attr("line/stroke","#000000")}))}},{key:"portEvent",value:function(t){var e=this,n=document.getElementById("app-content");t.on("node:mouseenter",u["d"].debounce((function(){var t=n.querySelectorAll(".x6-port-body");e.showPorts(t,!0)})),500),t.on("node:mouseleave",(function(){var t=n.querySelectorAll(".x6-port-body");e.showPorts(t,!1)}))}},{key:"showPorts",value:function(t,e){for(var n=0,i=t.length;n<i;n+=1)t[n].style.visibility=e?"visible":"hidden"}},{key:"initStencil",value:function(){var t=this,e=this.graph,n=new p({title:"战法模型",target:e,collapsable:!0,stencilGraphWidth:200,stencilGraphHeight:280,groups:[{name:"group1",title:"数据源"},{name:"group2",title:"基础模型"}]}),i=document.querySelector("#app-stencil");i.appendChild(n.container);var o="/x6model/dist/",a=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],r=[];a.forEach((function(e,n){r.push(t.newImage("table-"+n,"table",o+"table.svg","table-"+n+"bfawegawegasdgasdg"))}));var s=this.newImage("image-1","filter",o+"fliter.svg","过滤"),l=this.newImage("image-2","model",o+"jiao.svg","交集"),c=this.newImage("image-3","model",o+"bing.svg","并集"),u=this.newImage("image-4","model",o+"bu.svg","补集"),d=this.newImage("image-5","model",o+"cha.svg","差集");n.load(r,"group1"),n.load([u,d,s,l,c],"group2")}},{key:"newImage",value:function(t,e,n,i){return new f({shape:"html",width:40,height:40,data:{id:t,type:e,label:i},html:function(){var t=document.createElement("div"),e=document.createElement("div");e.setAttribute("class","zf-node-text"),e.setAttribute("title",i);var o=document.createElement("img");return t.setAttribute("class","zf-node-image"),o.src=n,o.width="30",e.innerText=i,t.appendChild(o),t.appendChild(e),t},attrs:{rect:{stroke:"#108ee9",strokeWidth:1},image:{opacity:1,"xlink:href":n},body:{magnet:!1},lable:{text:i||"",fill:"black",y:34}},ports:{groups:{in:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#31d0c6",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},out:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#31d0c6",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{id:"port1",group:"in"},{id:"port2",group:"out"}]}})}}]),t}(),g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"modal"}},[t.show?n("div",{staticClass:"cus-modal"},[n("div",{staticClass:"close",on:{click:t.close}},[n("i",{staticClass:"el-icon-close"})]),n("div",{staticClass:"header"},[t._t("header",[t._v(t._s(t.title)+"22222")])],2),n("div",{staticClass:"content"},[t._t("content")],2),n("div",{staticClass:"footer"},[t._t("footer")],2)]):t._e()])},m=[],v={props:{show:{required:!0,type:Boolean,default:function(){return!1}},title:String},methods:{close:function(){this.$emit("update:show",!1)}}},b=v,y=(n("91cc"),n("2877")),k=Object(y["a"])(b,g,m,!1,null,"6570c364",null),C=k.exports,w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tool-bar"},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"清除 (Cmd + D)",placement:"top-start"}},[n("i",{staticClass:"iconfont iconqingchu",attrs:{title:"清除"},on:{click:t.clear}})]),n("i",{staticClass:"el-icon-delete",attrs:{title:"删除节点|边"},on:{click:t.deleteCell}}),n("span",{staticClass:"line"}),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"清除 (Cmd + Shift + Z)",placement:"top-start"}},[n("i",{staticClass:"iconfont iconundo",attrs:{title:"撤销"},on:{click:t.undo}})]),n("i",{staticClass:"iconfont iconredo",attrs:{title:"重做"},on:{click:t.redo}}),n("span",{staticClass:"line"}),n("i",{staticClass:"el-icon-zoom-in",attrs:{title:"放大"},on:{click:function(e){t.scaleView(e,"up")}}}),n("i",{staticClass:"el-icon-zoom-out",attrs:{title:"缩小"},on:{click:function(e){t.scaleView(e,"down")}}}),n("span",{staticClass:"line"}),n("i",{staticClass:"iconfont iconcopy",attrs:{title:"复制"},on:{click:t.copy}}),n("i",{staticClass:"iconfont iconcut",attrs:{title:"剪切"},on:{click:t.cut}}),n("i",{staticClass:"iconfont iconpaste",attrs:{title:"粘贴"},on:{click:t.paste}}),n("span",{staticClass:"line"}),n("i",{staticClass:"iconfont iconsave",attrs:{title:"保存"},on:{click:t.save}}),n("i",{staticClass:"iconfont iconinterface_printer_line",attrs:{title:"打印"},on:{click:t.print}}),n("span",{staticClass:"toJSON",attrs:{title:"toJSON"},on:{click:t.toJSON}},[t._v("toJSON")]),n("span",{staticClass:"run",attrs:{title:"运行"},on:{click:t.runJSON}},[t._v("运行")])],1)},x=[],$=(n("c740"),n("bf19"),n("2ef0")),S=n.n($),O={name:"Toolbar",data:function(){return{oparation:{}}},mounted:function(){},methods:{clear:function(){this.$graph.clearCells(),this.showAttrConfig=!1},undo:function(){this.$graph.undo()},redo:function(){this.$graph.redo()},copy:function(){var t=this.$graph.getSelectedCells();t&&t.length?(this.$graph.copy(t),this.$message.success("复制成功")):this.$message.info("请先选中节点再复制")},cut:function(){var t=this.$graph.getSelectedCells();t.length&&this.$graph.cut(t)},paste:function(){if(this.$graph.isClipboardEmpty())this.$message.info("剪切板为空，不可粘贴");else{var t=this.$graph.paste(this.options);this.$graph.cleanSelection(),this.$graph.select(t),this.$message.success("粘贴成功")}},scaleView:function(t,e){t.preventDefault(),"up"===e?this.$graph.zoom(.1):this.$graph.zoom(-.1)},save:function(){this.$graph.toPNG((function(t){u["b"].downloadDataUri(t,"chart.png")}))},print:function(){this.$graph.printPreview()},toJSON:function(){var t=this,e=this.$graph.toJSON();console.log(e);var n=S.a.cloneDeep(e),i=this.$graph.getCells();console.log(this.$graph.getCells());var o=[];i.forEach((function(t){var e=t.store.data.data;o.push({id:t.id,label:e?e.label:"",data:e,node:t})})),console.log(o);var a=[];o.forEach((function(e){if(e.data&&"model"===e.data.type&&"过滤"!==e.label){a.push(e);var i=t.$graph.getPredecessors(e.node);if(console.log(i),2!=i.length){t.$message.error(e.label+"操作节点非法操作");var o=n["cells"].findIndex((function(t){return t.id===e.id}));n["cells"][o].data.connect=i}else{var r=n["cells"].findIndex((function(t){return t.id===e.id}));n["cells"][r].data.connect=i}}if(e.data&&"model"===e.data.type&&"过滤"===e.label){a.push(e);var s=t.$graph.getPredecessors(e.node);if(console.log(s),1!=s.length)t.$message.error(e.label+"操作节点非法操作");else{var l=n["cells"].findIndex((function(t){return t.id===e.id}));n["cells"][l].data.connect=s}}})),console.log(n)},deleteCell:function(){var t=this.$graph.getSelectedCells();this.$graph.removeCells(t)},runJSON:function(){var t=this.$graph.getCells();t.forEach((function(t){t instanceof u["c"]&&t.attr({line:{stroke:"#1890ff",strokeDasharray:5,targetMarker:"classic",style:{animation:"ant-line 30s infinite linear"}}})}))}}},_=O,E=(n("4f90"),Object(y["a"])(_,w,x,!1,null,null,null)),D=E.exports,P={data:function(){return{showAttrConfig:!1,nodeFrmData:{},viewTranslate:{graphX:0,graphY:0}}},beforeDestroy:function(){},mounted:function(){this.initRight()},methods:{initRight:function(){var t=h.init();i["default"].prototype.$graph=t},close:function(){this.showAttrConfig=!1},confirm:function(){var t=this.graph,e=t.getSelectedCell();e.setData(this.nodeFrmData);var n=e.style;if("html"===e.style.shape){e.style.html;var i=document.createElement("div");i.innerHTML=n.html,i.querySelector('[attr="name"]').innerText=this.nodeFrmData.name,n.html=i.innerHTML,e.setStyle(n)}else e.style.label=this.nodeFrmData.name;t.refresh(e),this.showAttrConfig=!1}},components:{Modal:C,Toolbar:D}},j=P,z=(n("3ae8"),Object(y["a"])(j,r,s,!1,null,null,null)),I=z.exports,N={name:"App",components:{EditorCom:I}},A=N,F=(n("5c0b"),Object(y["a"])(A,o,a,!1,null,null,null)),M=F.exports,J=n("5c96"),K=n.n(J);n("0fae"),n("5aea");i["default"].use(K.a),i["default"].config.productionTip=!1,new i["default"]({render:function(t){return t(M)}}).$mount("#app")},"5aea":function(t,e,n){},"5c0b":function(t,e,n){"use strict";var i=n("9c0c"),o=n.n(i);o.a},6186:function(t,e,n){},8614:function(t){t.exports=JSON.parse('{"cells":[{"attrs":{"body":{"magnet":false},"image":{"opacity":1,"xlink: href":"/table.svg"},"label":{"fill":"black","text":"","y":34},"rect":{"stroke":"#108ee9","strokeWidth":1}},"data":{"id":"table-2"},"id":"9e8f5591-9776-4fe0-bb86-07c2250da50a","ports":{"groups":{"in":{"attrs":{"circle":{"fill":"#fff","magnet":true,"r":4,"stroke":"#31d0c6","strokeWidth":1}},"position":"left"},"out":{"attrs":{"circle":{"fill":"#fff","magnet":true,"r":4,"stroke":"#31d0c6","strokeWidth":1}},"position":"right"}},"items":[{"group":"in","id":"port1"},{"group":"out","id":"port2"}]},"position":{"x":-560,"y":-170},"shape":"image-bordered","size":{"width":40,"height":40},"zIndex":1},{"attrs":{"body":{"magnet":false},"image":{"opacity":1,"xlink: href":"/cha.svg"},"label":{"fill":"black","text":"差集","y":34},"rect":{"stroke":"#108ee9","strokeWidth":1}},"data":{"id":"image-5"},"id":"7f8c35c6-0640-498c-90ea-d75a2d62f014","ports":{"groups":{"in":{"attrs":{"circle":{"fill":"#fff","magnet":true,"r":4,"stroke":"#31d0c6","strokeWidth":1}},"position":"left"},"out":{"attrs":{"circle":{"fill":"#fff","magnet":true,"r":4,"stroke":"#31d0c6","strokeWidth":1}},"position":"right"}},"items":[{"group":"in","id":"port1"},{"group":"out","id":"port2"}]},"position":{"x":-390,"y":-140},"shape":"image-bordered","size":{"width":40,"height":40},"zIndex":2},{"id":"915a314a-79a3-4773-b6a4-bb452703d06b","shape":"edge","source":{"cell":"9e8f5591-9776-4fe0-bb86-07c2250da50a","port":"port2"},"target":{"cell":"7f8c35c6-0640-498c-90ea-d75a2d62f014","port":"port1"},"zIndex":3}]}')},"91cc":function(t,e,n){"use strict";var i=n("2010"),o=n.n(i);o.a},"9c0c":function(t,e,n){},f5c4:function(t,e,n){}});
//# sourceMappingURL=app.fb1b890d.js.map